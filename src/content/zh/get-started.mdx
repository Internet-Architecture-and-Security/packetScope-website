import { Steps } from 'nextra/components'

# å¼€å§‹ä½¿ç”¨

## å®‰è£…è§†é¢‘

<iframe height={500} width={800} src="//player.bilibili.com/player.html?isOutside=true&aid=115099989710545&bvid=BV1LZe2zfE1m&cid=25849958746&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe>

## å‰ç½®è¦æ±‚

å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„ç³»ç»Ÿå·²å®‰è£…å¹¶è¿è¡Œ Dockerï¼š

- **Docker**ï¼šç‰ˆæœ¬ 20.10 æˆ–æ›´é«˜
- **Docker Compose**ï¼šç‰ˆæœ¬ 2.0 æˆ–æ›´é«˜

éªŒè¯ Docker å®‰è£…ï¼š

```bash
docker --version
docker compose version
```

å¦‚æœå°šæœªå®‰è£… Dockerï¼Œè¯·è®¿é—® [Docker å®˜æ–¹ç½‘ç«™](https://docs.docker.com/get-docker/) è·å–å®‰è£…è¯´æ˜ã€‚

## ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

PacketScope æä¾›äº†ä¾¿æ·çš„éƒ¨ç½²è„šæœ¬ï¼Œå¯ä½¿ç”¨ Docker Compose è‡ªåŠ¨æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚

<Steps>

### å…‹éš†ä»“åº“

```bash
git clone https://github.com/Internet-Architecture-and-Security/PacketScope.git
cd PacketScope
```

### è¿è¡Œéƒ¨ç½²è„šæœ¬

ä½¿ç”¨ root æƒé™æ‰§è¡Œå¯åŠ¨è„šæœ¬ï¼š

```bash
sudo bash starter.sh
```

è¯¥è„šæœ¬å°†è‡ªåŠ¨å®Œæˆä»¥ä¸‹æ“ä½œï¼š
- âœ“ æ£€æŸ¥ Docker ç¯å¢ƒ
- âœ“ åœæ­¢ç°æœ‰æœåŠ¡
- âœ“ æŒ‰æ­£ç¡®é¡ºåºæ„å»ºæ‰€æœ‰æœåŠ¡å®¹å™¨
- âœ“ å¯åŠ¨æ‰€æœ‰æœåŠ¡
- âœ“ æ˜¾ç¤ºæœåŠ¡çŠ¶æ€å’Œè®¿é—®ä¿¡æ¯

### è®¿é—®åº”ç”¨

éƒ¨ç½²å®Œæˆåï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š

```
http://localhost:4173/
```

</Steps>

## æœåŠ¡ç«¯ç‚¹

éƒ¨ç½²æˆåŠŸåï¼Œä»¥ä¸‹æœåŠ¡å°†å¯ç”¨ï¼š

| æœåŠ¡ | ç«¯å£ | è®¿é—®åœ°å€ |
|------|------|----------|
| Web UI | 4173 | http://localhost:4173 |
| Guarder API | 8080 | http://localhost:8080 |
| Tracer API | 8000 | http://localhost:8000 |
| Analyzer-Monitor API | 5000 | http://localhost:5000 |
| Analyzer-ProtocolStack API | 19999 | http://localhost:19999 |

## æœåŠ¡ç®¡ç†

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
sudo docker compose ps
```

### æŸ¥çœ‹æœåŠ¡æ—¥å¿—

æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çš„æ—¥å¿—ï¼š
```bash
sudo docker compose logs -f
```

æŸ¥çœ‹ç‰¹å®šæœåŠ¡çš„æ—¥å¿—ï¼š
```bash
sudo docker compose logs -f <æœåŠ¡åç§°>
```

å¯ç”¨çš„æœåŠ¡åç§°ï¼š
- `web-ui` - å‰ç«¯ç•Œé¢
- `guarder` - å®‰å…¨é˜²æŠ¤æ¨¡å—
- `tracer` - ç½‘ç»œè¿½è¸ªæ¨¡å—
- `analyzer-monitor` - æµé‡ç›‘æ§æ¨¡å—
- `analyzer-protocolstack` - åè®®æ ˆåˆ†ææ¨¡å—

### åœæ­¢æ‰€æœ‰æœåŠ¡

```bash
sudo docker compose down
```

### é‡å¯æœåŠ¡

é‡å¯æ‰€æœ‰æœåŠ¡ï¼š
```bash
sudo docker compose restart
```

é‡å¯ç‰¹å®šæœåŠ¡ï¼š
```bash
sudo docker compose restart <æœåŠ¡åç§°>
```

### æ›´æ–°æœåŠ¡

å¦‚æœä»£ç æœ‰æ›´æ–°ï¼Œéœ€è¦é‡æ–°æ„å»ºå’Œéƒ¨ç½²ï¼š

```bash
# åœæ­¢å¹¶ç§»é™¤ç°æœ‰å®¹å™¨
sudo docker compose down

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
sudo bash starter.sh
```

æˆ–è€…åªé‡æ–°æ„å»ºç‰¹å®šæœåŠ¡ï¼š

```bash
sudo docker compose up -d --build <æœåŠ¡åç§°>
```

## æ‰‹åŠ¨éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

å¦‚æœæ‚¨éœ€è¦æ‰‹åŠ¨éƒ¨ç½²æˆ–è¿›è¡Œé«˜çº§é…ç½®ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹æ­¥éª¤ã€‚

### å¯åŠ¨æœåŠ¡ç«¯æ¨¡å—

æœ¬é¡¹ç›®åŒ…å«å¤šä¸ªç”¨ä¸åŒè¯­è¨€å®ç°çš„æœåŠ¡ç«¯æ¨¡å—ã€‚è¯·å‚ç…§æ¯ä¸ªæ¨¡å—çš„ `README.md` æ–‡ä»¶å®‰è£…ä¾èµ–å¹¶å¯åŠ¨æœåŠ¡ã€‚

```bash
modules
â”œâ”€â”€ Analyzer  # åŸºäº Python çš„åè®®æ ˆåˆ†ææ¨¡å—
â”‚   â”œâ”€â”€ Monitor/           # æµé‡ç›‘æ§å­æ¨¡å—
â”‚   â””â”€â”€ ProtocolStack/     # åè®®åˆ†æå­æ¨¡å—
â”œâ”€â”€ Guarder   # åŸºäº Go çš„å®‰å…¨ç­–ç•¥æ¨¡å—
â””â”€â”€ Tracer    # åŸºäº Python çš„ç½‘ç»œè·¯å¾„æ˜ å°„æ¨¡å—
```

#### Analyzer æ¨¡å—

Analyzer æ¨¡å—åŒ…å«ä¸¤ä¸ªå­æ¨¡å—ï¼šMonitor å’Œ ProtocolStackã€‚

è¿›å…¥ Monitor ç›®å½•ï¼š
```bash
cd modules/Analyzer/Monitor
```

å®‰è£…ä¾èµ–å¹¶å¯åŠ¨ï¼š
```bash
pip install -r requirements.txt
python app.py
```

è¿›å…¥ ProtocolStack ç›®å½•ï¼š
```bash
cd modules/Analyzer/ProtocolStack
```

å®‰è£…ä¾èµ–å¹¶å¯åŠ¨ï¼š
```bash
pip install -r requirements.txt
python app.py
```

#### Guarder æ¨¡å—

è¿›å…¥ Guarder ç›®å½•ï¼š
```bash
cd modules/Guarder
```

å®‰è£…ä¾èµ–å¹¶å¯åŠ¨ï¼š
```bash
go mod download
go run main.go
```

#### Tracer æ¨¡å—

è¿›å…¥ Tracer ç›®å½•ï¼š
```bash
cd modules/Tracer
```

å®‰è£…ä¾èµ–å¹¶å¯åŠ¨ï¼š
```bash
pip install -r requirements.txt
python app.py
```

### å¯åŠ¨å‰ç«¯æœåŠ¡

<Steps>

å‰ç«¯åŸºäº [Node.js](https://nodejs.org/en) æ„å»ºã€‚è¯·ç¡®ä¿å·²å®‰è£… Node.jsï¼ˆç‰ˆæœ¬ â‰¥ 16ï¼‰ã€‚

#### å®‰è£…ä¾èµ–

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```sh npm2yarn
npm install
```

> [!NOTE]
>
> ä¸­å›½å¤§é™†ç”¨æˆ·å¯è®¾ç½® npm é•œåƒä»¥åŠ é€Ÿå®‰è£…ï¼š
> ```bash
> npm config set registry http://registry.npmmirror.com
> ```

#### å¯åŠ¨é¢„è§ˆæœåŠ¡å™¨

```sh npm2yarn
npm run preview
```

åº”ç”¨ç¨‹åºé»˜è®¤åœ¨æœ¬åœ°ç«¯å£ `4173` è¿è¡Œã€‚

#### è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨å¹¶è®¿é—®ï¼š

```
http://127.0.0.1:4173/
```

</Steps>

> [!TIP]
>
> è¦åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œå¹¶å¯ç”¨çƒ­é‡è½½ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
>
> ```sh npm2yarn
> npm run dev
> ```

> [!TIP]
>
> è¦æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
>
> ```sh npm2yarn
> npm run build
> ```

## å¸¸è§é—®é¢˜

### Docker æƒé™é—®é¢˜

å¦‚æœé‡åˆ° Docker æƒé™é”™è¯¯ï¼Œè¯·ç¡®ä¿æ‚¨çš„ç”¨æˆ·åœ¨ docker ç»„ä¸­ï¼š

```bash
sudo usermod -aG docker $USER
```

ç„¶åé‡æ–°ç™»å½•æˆ–è¿è¡Œï¼š

```bash
newgrp docker
```

### ç«¯å£å†²çª

å¦‚æœé»˜è®¤ç«¯å£è¢«å ç”¨ï¼Œæ‚¨å¯ä»¥ï¼š

1. æ£€æŸ¥å ç”¨ç«¯å£çš„è¿›ç¨‹ï¼š
```bash
sudo lsof -i :4173
```

2. åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹ï¼Œæˆ–åœ¨ `docker-compose.yml` ä¸­ä¿®æ”¹ç«¯å£æ˜ å°„

### æœåŠ¡æ— æ³•å¯åŠ¨

1. æ£€æŸ¥ Docker æ—¥å¿—ä»¥è¯Šæ–­é—®é¢˜ï¼š
```bash
sudo docker compose logs <æœåŠ¡åç§°>
```

2. ç¡®ä¿æ‰€æœ‰å¿…éœ€çš„ç«¯å£æœªè¢«å ç”¨

3. éªŒè¯ Docker å’Œ Docker Compose ç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚

### æ„å»ºå¤±è´¥

å¦‚æœæ„å»ºè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼š

1. æ¸…ç† Docker ç¼“å­˜ï¼š
```bash
sudo docker system prune -a
```

2. é‡æ–°æ„å»ºï¼š
```bash
sudo bash starter.sh
```

### ç½‘ç»œè¿æ¥é—®é¢˜

å¦‚æœå‰ç«¯æ— æ³•è¿æ¥åˆ°åç«¯æœåŠ¡ï¼š

1. æ£€æŸ¥æ‰€æœ‰æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š
```bash
sudo docker compose ps
```

2. éªŒè¯æœåŠ¡ç«¯å£æ˜¯å¦æ­£ç¡®æ˜ å°„

3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®æ˜¯å¦é˜»æ­¢äº†ç«¯å£è®¿é—®

### æ€§èƒ½é—®é¢˜

å¦‚æœæœåŠ¡è¿è¡Œç¼“æ…¢ï¼š

1. æ£€æŸ¥ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µï¼š
```bash
sudo docker stats
```

2. å¢åŠ  Docker å¯ç”¨èµ„æºï¼ˆå†…å­˜ã€CPUï¼‰

3. æ£€æŸ¥æ—¥å¿—ä¸­æ˜¯å¦æœ‰é”™è¯¯æˆ–è­¦å‘Šä¿¡æ¯

## æ•…éšœæ’é™¤

### å®Œå…¨é‡ç½®

å¦‚æœé‡åˆ°æ— æ³•è§£å†³çš„é—®é¢˜ï¼Œå¯ä»¥å®Œå…¨é‡ç½®ç¯å¢ƒï¼š

```bash
# åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰å®¹å™¨
sudo docker compose down -v

# åˆ é™¤æ‰€æœ‰ç›¸å…³é•œåƒ
sudo docker images | grep packetscope | awk '{print $3}' | xargs sudo docker rmi -f

# é‡æ–°éƒ¨ç½²
sudo bash starter.sh
```

### è·å–å¸®åŠ©

å¦‚éœ€æ›´å¤šå¸®åŠ©ï¼Œè¯·ï¼š

1. æŸ¥çœ‹ [GitHub Issues](https://github.com/Internet-Architecture-and-Security/PacketScope/issues)
2. æŸ¥çœ‹å„æ¨¡å—çš„è¯¦ç»†æ–‡æ¡£
3. æäº¤æ–°çš„ Issue å¹¶é™„ä¸Šè¯¦ç»†çš„é”™è¯¯æ—¥å¿—

## ä¸‹ä¸€æ­¥

æˆåŠŸéƒ¨ç½² PacketScope åï¼Œæ‚¨å¯ä»¥ï¼š

- ğŸ“Š æ¢ç´¢ [Analyzer æ¨¡å—](/docs/modules/analyzer) - åˆ†æåè®®æ ˆæ€§èƒ½
- ğŸ” ä½¿ç”¨ [Tracer æ¨¡å—](/docs/modules/tracer) - è¿½è¸ªç½‘ç»œè·¯å¾„
- ğŸ›¡ï¸ é…ç½® [Guarder æ¨¡å—](/docs/modules/guarder) - è®¾ç½®å®‰å…¨ç­–ç•¥
- ğŸ“š é˜…è¯» [ç”¨æˆ·æŒ‡å—](/docs/user-guide) - äº†è§£æ›´å¤šåŠŸèƒ½

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼