import { Bleed } from 'nextra/components'

# 介绍

> PacketScope：服务端防御的"智能盔甲"

**PacketScope** 是一个基于 eBPF 的通用协议栈分析和调试工具。它集成了性能优化、异常诊断和安全防御功能。旨在在服务端实现协议栈级别的网络数据包细粒度追踪和智能分析。通过解决三大痛点——性能瓶颈难诊断、传输路径不清晰、底层攻击难检测——PacketScope 提供可视化、智能的端侧安全分析和防御能力。


  👏🏻 欢迎 👏🏻 扫描加入 **PacketScope** 技术交流群
  <img src="/qrcode.png" alt="QR Code" width="300" />

## 背景

随着社交平台、网上银行、大规模 AI 模型、物流和旅行服务的普及，开放服务器已成为关键的执行环境。这些服务器必须在公开访问的条件下平衡性能和安全性。传统的 WAF 和 IDS 工具在协议栈级别的防御存在盲点，PacketScope 正是为了解决这一问题：

> **🚨 三大核心痛点：**
>
> 1. 数据包在协议栈中的路径不清晰，导致瓶颈和故障难以诊断
> 2. 缺乏细粒度的跨域传输数据，使路由风险不可见
> 3. 底层协议栈攻击隐蔽性强，传统工具难以检测

为应对上述挑战，**清华大学徐恪教授团队基于近十年协议栈安全研究积累，研发了PacketScope_v1.1项目**。项目提出了一种创新性解决方案：通过eBPF技术，在协议栈处理路径上动态观测、实时感知每一个分组单元在系统内的处理轨迹，绘制协议交互全景图，再辅助以大模型分析，实现协议栈内核级别的分组可视化、安全性分析与零延迟防御。

PacketScope通过实时观测追踪网络分组穿越协议栈交互信息、构建细粒度协议交互图，查找定位交互风险点及性能处理瓶颈点。此外通过统计分析协议分组处理延迟、跨协议交互频率，对关键路径动态插桩，捕获 socket连接状态。通过调用团队研发的TrafficLLM流量大模型、以及DeepSeeK、ChatGPT等通用大模型，PacketScope实现了对攻击流量实时分析、规则生成、及拦截阻断。通过eBPF XDP等方式导入分组流量到大模型。大模型依据交互式网络攻击特征提示，对流量进行深入分析，判别socket连接行为，识别恶意攻击威胁，并生成eBPF安全过滤规则，支持内核级协议栈防御。

## 🚀 核心能力

- 🧠 **智能引擎**：结合 eBPF 与大型语言模型，进行底层网络行为观察和智能安全防御
- 📊 **多维度分析**：实时跟踪网络路径，统计延迟、丢包、交互频率
- 🌐 **全球网络可视化**：映射全球路径和延迟，以拓扑图形式呈现
- 🔐 **协议栈防御**：检测和拦截底层异常流量，覆盖传统 WAF/IDS 的盲点
- 🖥️ **用户友好界面**：为安全工程师和运维人员设计的易用 GUI


## ✨ 功能模块

- **Tracer（追踪器）**

  跟踪协议栈中连接/数据包的交互，生成详细的可视化路径图。用户可以点击探索不同协议层，了解数据流向。

- **Analyzer（分析器）**

  提供数据包在协议栈中移动的多维度统计，包括流量、延迟、跨层交互频率和丢包情况。

- **Locator（定位器）**

  映射从主机到任意全球 IP 地址的路由和延迟，在全球拓扑图上显示这些数据以提供优化洞察。

- **Guarder（守护者）**

  使用可自定义规则过滤和控制异常数据包，并提供基于大型语言模型的上下文洞察，帮助解释和响应潜在威胁。

## 🧰 使用场景

- **网络协议栈性能优化**：识别瓶颈并提高传输效率
- **威胁检测和安全防御**：检测和阻止 DDoS、ARP 欺骗等潜在攻击
- **故障诊断**：诊断由延迟、丢包或异常跨层行为引起的问题
- **拓扑分析**：分析跨区域部署中的路径延迟和路由性能
- **工业互联网安全**：实时监控工业控制系统，确保安全性和完整性

## ❤️ 贡献

我们欢迎 issue 和 pull request！如果您发现错误或有建议，请提交 issue 或 PR。

## 许可证

本项目使用 MIT 许可证。